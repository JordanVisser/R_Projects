
### Data Set

-   These data come from [Kaggle](https://www.kaggle.com/cdc/behavioral-risk-factor-surveillance-system).
-   About Dataset:

The objective of the BRFSS is to collect uniform, state-specific data on preventive health practices and risk
behaviors that are linked to chronic diseases, injuries, and preventable infectious diseases in the adult population.
Factors assessed by the BRFSS include tobacco use, health care coverage, HIV/AIDS knowledge or prevention,
physical activity, and fruit and vegetable consumption. Data are collected from a random sample of adults (one per
household) through a telephone survey.

The Behavioral Risk Factor Surveillance System (BRFSS) is the nation's premier system of health-related telephone surveys that collect state data about U.S. residents regarding their health-related risk behaviors, chronic health conditions, and use of preventive services. Established in 1984 with 15 states, BRFSS now collects data in all 50 states as well as the District of Columbia and three U.S. territories. BRFSS completes more than 400,000 adult interviews each year, making it the largest continuously conducted health survey system in the world.

```{r}

rm(list = ls())
library(tidyverse) 
brf <- read_csv("BRFSS2015_650.csv")

```

```{r}

Q1 <- brf %>%
  filter(GENHLTH == 1) %>%
  count() %>%
  pull(n) %>%
  as.integer()

Q1

```

```{r}

Q2 <- brf %>%
  filter(CVDSTRK3 == 1) %>%
  summarise(max_num_women = max(NUMWOMEN, na.rm = TRUE)) %>%
  as.data.frame()

Q2


```

```{r}

Q3 <- brf %>%
  filter(
    CRGVPERS %in% c(1, 2) &
    (MENTHLTH %in% c(0, 88) | (MENTHLTH >= 1 & MENTHLTH <= 30))
  ) %>%
  mutate(MENTHLTH = ifelse(MENTHLTH == 88, 0, MENTHLTH)) %>%
  group_by(CRGVPERS) %>%
  summarise(
    mean_mental = mean(MENTHLTH, na.rm = TRUE),
    sd_mental = sd(MENTHLTH, na.rm = TRUE)
  ) %>%
  round(2) %>%
  as.data.frame()

Q3

```

```{r}

Q4 <- brf %>%
  filter(!is.na(DIABAGE2), `_STATE` == 42, !(DIABAGE2 %in% c(98, 99))) %>%
  summarize(med_diab_age = median(DIABAGE2)) %>%
  as.data.frame()

Q4

```

```{r}

Q5 <- brf %>%
  filter((MENTHLTH %in% c(0, 88) | (MENTHLTH >= 1 & MENTHLTH <= 30))) %>%
  filter(!MARITAL %in% c(9)) %>%
  mutate(MENTHLTH = ifelse(MENTHLTH == 88, 0, MENTHLTH)) %>%
  mutate(MARITAL = factor(MARITAL)) %>%
  lm(MENTHLTH ~ MARITAL, data = .) %>%
  summary() 

Q5

```

```{r}

Q6 <- brf %>%
  filter((MENTHLTH %in% c(0, 88) | (MENTHLTH >= 1 & MENTHLTH <= 30))) %>%
  mutate(MENTHLTH = ifelse(MENTHLTH == 88, 0, MENTHLTH)) %>%
  filter(MARITAL != 9) %>%
  group_by(MARITAL) %>%
  summarise(mean_mental = mean(MENTHLTH, na.rm = TRUE)) %>%
  round(2) %>%
  as.data.frame()

Q6

```

```{r}

Q7 <- brf %>%
  filter(HLTHPLN1 == 2) %>%
  filter((MENTHLTH %in% c(0, 88) | (MENTHLTH >= 1 & MENTHLTH <= 30))) %>%
  mutate(MENTHLTH = ifelse(MENTHLTH == 88, 0, MENTHLTH)) %>%
  group_by(CVDSTRK3) %>%
  summarise(
    mean_mental = mean(MENTHLTH, na.rm = TRUE),
    sd_mental = sd(MENTHLTH, na.rm = TRUE)
  ) %>%
  filter(CVDSTRK3 %in% c(1, 2)) %>%
  round(2) %>%
  as.data.frame()

Q7

```

```{r}

Q8 <- brf %>% 
  filter(!is.na(MARITAL), !is.na(EXEROFT1)) %>%
  filter(MARITAL != 9) %>%
  filter(between(EXEROFT1, 101, 199)) %>%
  mutate(MARITAL = factor(MARITAL)) %>%
  aov(EXEROFT1 ~ MARITAL, data = .) %>% 
  summary()

Q8

```

```{r}

brfcopy <- data_frame(brf)

brfcopy_filtered <- brfcopy %>%
  filter(!is.na(EXRACT11), SEX == 1) %>%
  filter(!ALCDAY5 %in% c(201:299,777, 999)) %>%
  mutate(ALCDAY5 = ifelse(ALCDAY5 %in% 101:199, ALCDAY5 - 100, ALCDAY5)) %>%
  mutate(ALCDAY5 = ifelse(ALCDAY5 == 888, 0, ALCDAY5))

Q9 <- brfcopy_filtered %>%
  group_by(EXRACT11) %>%
  summarize(var_drinks = var(ALCDAY5, na.rm = TRUE)) %>%
  arrange(desc(var_drinks)) %>%
  head(6) %>%
  round(2) %>%
  as.data.frame()

Q9

```
